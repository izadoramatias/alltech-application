{% extends 'base.html.twig' %}
{% block title %}Novo equipamento{% endblock %}
{% block body %}
    <div class="bg-light min-vh-100">
        <div class="container-lg bg-light">
            <div class="row p-5">
                <div class="position-relative w-100">
                    <h3 class="fw-bolder text-center">Registro de equipamento</h3>
                    <div class="position-absolute top-0 end-0">
                        <a class="text-light text-decoration-none" href="/dashboard" methods="get">
                            <button class="btn btn-dark fw-semibold">
                                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><style>svg{fill:#f0f0f0}</style><path d="M512 256A256 256 0 1 0 0 256a256 256 0 1 0 512 0zM231 127c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-71 71L376 232c13.3 0 24 10.7 24 24s-10.7 24-24 24l-182.1 0 71 71c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0L119 273c-9.4-9.4-9.4-24.6 0-33.9L231 127z"/></svg>
                                Voltar
                            </button>
                        </a>
                    </div>
                </div>
            </div>
            <div>
                <form class="row g-5 was-validated d-flex flex-column justify-content-center align-items-center mt-3" action="{{ path('app_register_equipment_request') }}" method="post" novalidate>
                    <div class="col-md-8">
                        <label for="donator" class="form-label fw-semibold ">Doador</label>
                        <div class="input-group input-group-lg">
                            <span class="input-group-text">
                                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><style>svg{fill:#e4dede}</style><path d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"/></svg>
                            </span>
                            <input value="{{ donator }}" maxlength="45" name="donator" placeholder="Doador" type="text" class="form-control form-control-lg fs-6" id="donator" required>
                            <div class="invalid-feedback">Campo "doador" não pode ser vazio</div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <label for="description" class="form-label fw-semibold">Descrição do equipamento</label>
                        <div class="input-group input-group-lg">
                            <span class="input-group-text">
                            <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><style>svg{fill:#e4dede}</style><path d="M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"/></svg>
                            </span>
                            <input value="{{ description }}" maxlength="45" name="description" placeholder="Descrição do equipamento" type="text" class="form-control form-control-lg fs-6" id="description" required>
                            <div class="invalid-feedback">Campo "descrição do equipamento" não pode ser vazio</div>
                        </div>
                        <div class="characters-counter">
                            <p style="font-size: 14px;" class="text-black-50">Caracteres restantes: <span id="characters-left">45</span></p>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <label for="receiptData" class="form-label fw-semibold">Data de recebimento</label>
                        <div class="input-group input-group-lg">
                            <span class="input-group-text">
                                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><style>svg{fill:#e4dede}</style><path d="M128 0c17.7 0 32 14.3 32 32V64H288V32c0-17.7 14.3-32 32-32s32 14.3 32 32V64h48c26.5 0 48 21.5 48 48v48H0V112C0 85.5 21.5 64 48 64H96V32c0-17.7 14.3-32 32-32zM0 192H448V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V192zm64 80v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16zm128 0v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V272c0-8.8-7.2-16-16-16H336zM64 400v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H80c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H208zm112 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V400c0-8.8-7.2-16-16-16H336c-8.8 0-16 7.2-16 16z"/></svg>
                            </span>
                            <input value="{{ receiptDate }}" name="receiptDate" placeholder="Data de recebimento" type="date" class="form-control form-control-lg fs-6" id="receiptDate" required>
                            <div class="invalid-feedback">Campo "data de recebimento" não pode ser vazio</div>
                        </div>
                    </div>
                    <input type="hidden" id="submitButton" name="submitButton" value="">
                    <div class="d-flex align-items-center justify-content-center gap-2 pt-5">
                        <button type="submit" onclick="setSubmitType('backToRegister')" class="btn btn-lg btn-secondary px-5 text-center">Registrar e cadastrar um novo</button>
                        <button type="submit" onclick="setSubmitType('backToListing')" class="btn btn-lg btn-danger px-5 text-center">Registrar</button>
                    </div>
                </form>
            </div>
            <div class="position-absolute end-0 bottom-0 me-4 mb-4">
                <img src="{{ asset('images/logo-fatec-black.svg') }}" alt="">
            </div>
        </div>
    </div>

    {% block javascripts %}
        <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

        <script>
            function setSubmitType(buttonId) {
                document.getElementById('submitButton').value = buttonId;
            }

            (function ($) {
                let totalRemaining = parseInt($('#characters-left').text());
                $('#description').on('input', () => {
                    let totalEntered = $('#description').val().length;
                    let subtraction = totalRemaining - totalEntered;

                    $('#characters-left').text(subtraction)
                })
            }(jQuery));

        </script>
    {% endblock %}
{% endblock %}